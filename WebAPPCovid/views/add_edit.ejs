<!DOCTYPE html>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AddEdit</title>
</head>
<body>
    <script>
        function edit(date, new_Amount, old_GetWell_Amount, died_Amount, covidID, flag) {
            var userPreference;
            if (flag === 'add'){
                if (confirm("Do you want to save changes?") == true) {
                var _date = document.getElementById("date").value;
                var _new_Amount = document.getElementById("new_Amount").value;
                var _old_GetWell_Amount = document.getElementById("old_GetWell_Amount").value;
                var _died_Amount = document.getElementById("died_Amount").value;
                var _covidID = document.getElementById("covidID").value;                               
                location.href = `/add?edit=add&date=${_date}&new_Amount=${_new_Amount}&old_GetWell_Amount=${_old_GetWell_Amount}&died_Amount=${_died_Amount}&covidID=${_covidID}&flag=${flag}`    
                // userPreference = "Data saved successfully!";
                } else {
                    // userPreference = "Save Cancelled!";
                }
            }
            else
            {
                if (confirm("Do you want to save changes?") == true) {
                var _date = document.getElementById("date").value;
                var _new_Amount = document.getElementById("new_Amount").value;
                var _old_GetWell_Amount = document.getElementById("old_GetWell_Amount").value;
                var _died_Amount = document.getElementById("died_Amount").value;
                var _covidID = document.getElementById("covidID").value;                               
                location.href = `/add_edit?edit=update&date=${_date}&new_Amount=${_new_Amount}&old_GetWell_Amount=${_old_GetWell_Amount}&died_Amount=${_died_Amount}&covidID=${_covidID}`    
                // userPreference = "Data saved successfully!";
                } else {
                    // userPreference = "Save Cancelled!";
                }
            }                      
        }
    </script>
    <div class="container">
        <form>
            <div class="mt-3 form-group row">
                <div class="col-sm-3">
                    <label for="exampleFormControlInput1">วันที่</label>
                    <input type="datetime-local" class="form-control" id="date" >
                    <script> 
                        var now = new Date('<%= date %>');
                        now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
                        document.getElementById('date').value = now.toISOString().slice(0,16);
                    </script>             
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-3">
                    <label for="exampleFormControlInput1">จำนวนผู้ติดเชื้อใหม่</label>
                    <input type="number" class="form-control" id="new_Amount" step="1" value=<%= new_Amount %>                  
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-3">
                    <label for="exampleFormControlInput1">จำนวนผู้ติดเชื้อเดิมหายป่วย</label>
                    <input type="number" class="form-control" id="old_GetWell_Amount" step="1" value=<%= old_GetWell_Amount %>>                    
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-3">
                    <label for="exampleFormControlInput1">จำนวนผู้เสียชีวิต</label>
                    <input type="number" class="form-control" id="died_Amount" step="1" value=<%= died_Amount %>>              
                    <input type="hidden" class="form-control" id="covidID" step="1" value=<%= covidID %>>           
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-3">
                    <button type="button" class="btn btn-outline-primary" 
                        onclick="edit('<%= date %>', 
                        '<%= new_Amount %>', 
                        '<%= old_GetWell_Amount %>', 
                        '<%= died_Amount %>',
                        '<%= covidID %>',
                        '<%= flag %>'
                        )"
                    >บันทึก</button>
                    <button type="button" class="btn btn-secondary" onclick="location.href='/'">ยกเลิก</button>

                </div>
            </div>
        </form>
    </div>        
</body>
</html>